<!DOCTYPE html>
<!-- saved from url=(0101)file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2.html -->
<html xmlns:cc="http://creativecommons.org/ns#"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=contain"><title>Creating insanely fast image classifiers with MobileNet in TensorFlow</title><link rel="canonical" href="https://hackernoon.com/creating-insanely-fast-image-classifiers-with-mobilenet-in-tensorflow-f030ce0a2991"><meta name="title" content="Creating insanely fast image classifiers with MobileNet in TensorFlow"><meta name="referrer" content="always"><meta name="description" content="MobileNets are a new family of convolutional neural networks that are set to blow your mind, and today we’re going to train one on a custom dataset. Why is this important? Many mobile deep learning…"><meta name="theme-color" content="#000000"><meta property="og:title" content="Creating insanely fast image classifiers with MobileNet in TensorFlow"><meta property="twitter:title" content="Creating insanely fast image classifiers with MobileNet in TensorFlow"><meta property="og:url" content="https://hackernoon.com/creating-insanely-fast-image-classifiers-with-mobilenet-in-tensorflow-f030ce0a2991"><meta property="og:image" content="https://cdn-images-1.medium.com/max/1200/1*ABXyqKiGauuI-GXukp5QFw.jpeg"><meta property="fb:app_id" content="542599432471018"><meta property="og:description" content="“It’s like hot dog not hot dog, but for roads.”"><meta name="twitter:description" content="“It’s like hot dog not hot dog, but for roads.”"><meta name="twitter:image:src" content="https://cdn-images-1.medium.com/max/1200/1*ABXyqKiGauuI-GXukp5QFw.jpeg"><link rel="publisher" href="https://plus.google.com/103654360130207659246"><link rel="author" href="https://hackernoon.com/@harvitronix"><meta property="author" content="Matt Harvey"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta property="article:publisher" content="https://www.facebook.com/hackernoon"><meta property="article:author" content="10207177641793333"><meta name="robots" content="index, follow"><meta property="article:published_time" content="2017-07-11T15:43:15.513Z"><meta name="twitter:creator" content="@harvitronix"><meta name="twitter:site" content="@hackernoon"><meta property="og:site_name" content="Hacker Noon"><meta name="twitter:label1" value="Reading time"><meta name="twitter:data1" value="8 min read"><meta name="twitter:app:name:iphone" content="Medium"><meta name="twitter:app:id:iphone" content="828256236"><meta name="twitter:app:url:iphone" content="medium://p/f030ce0a2991"><meta property="al:ios:app_name" content="Medium"><meta property="al:ios:app_store_id" content="828256236"><meta property="al:android:package" content="com.medium.reader"><meta property="al:android:app_name" content="Medium"><meta property="al:ios:url" content="medium://p/f030ce0a2991"><meta property="al:android:url" content="medium://p/f030ce0a2991"><meta property="al:web:url" content="https://hackernoon.com/creating-insanely-fast-image-classifiers-with-mobilenet-in-tensorflow-f030ce0a2991"><link rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://hackernoon.com/osd.xml"><link rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/f030ce0a2991"><script async="" src="./creating_clasifiers_mobilenet_tensorflow_files/branch-latest.min.js"></script><script async="" src="./creating_clasifiers_mobilenet_tensorflow_files/branch-latest.min(1).js"></script><script async="" src="./creating_clasifiers_mobilenet_tensorflow_files/branch-latest.min(2).js"></script><script type="application/ld+json">{"@context":"http://schema.org","@type":"NewsArticle","image":{"@type":"ImageObject","width":960,"height":416,"url":"https://cdn-images-1.medium.com/max/960/1*ABXyqKiGauuI-GXukp5QFw.jpeg"},"url":"https://hackernoon.com/creating-insanely-fast-image-classifiers-with-mobilenet-in-tensorflow-f030ce0a2991","dateCreated":"2017-07-11T15:43:15.513Z","datePublished":"2017-07-11T15:43:15.513Z","dateModified":"2018-06-19T09:13:21.755Z","headline":"Creating insanely fast image classifiers with MobileNet in TensorFlow","name":"Creating insanely fast image classifiers with MobileNet in TensorFlow","thumbnailUrl":"https://cdn-images-1.medium.com/max/960/1*ABXyqKiGauuI-GXukp5QFw.jpeg","keywords":["Tag:Machine Learning","Tag:Deep Learning","Tag:Mobilenet","Tag:TensorFlow","Tag:Artificial Intelligence","Publication:hacker-daily","LockedPostSource:0","Elevated:false","LayerCake:0"],"author":{"@type":"Person","name":"Matt Harvey","url":"https://hackernoon.com/@harvitronix"},"creator":["Matt Harvey"],"publisher":{"@type":"Organization","name":"Hacker Noon","url":"https://hackernoon.com","logo":{"@type":"ImageObject","width":417,"height":60,"url":"https://cdn-images-1.medium.com/max/417/1*9gEoquKtElHxl0YMs_-RTA.png"}},"mainEntityOfPage":"https://hackernoon.com/creating-insanely-fast-image-classifiers-with-mobilenet-in-tensorflow-f030ce0a2991"}</script><meta name="parsely-link" content="https://hackernoon.com/creating-insanely-fast-image-classifiers-with-mobilenet-in-tensorflow-f030ce0a2991"><link rel="stylesheet" type="text/css" class="js-glyph-" id="glyph-8" href="./creating_clasifiers_mobilenet_tensorflow_files/m2.css"><link rel="stylesheet" href="./creating_clasifiers_mobilenet_tensorflow_files/main-branding-base.UjvZohwPi22_QspsW__IUw.css"><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener("error", _onerror, true); else if (document.attachEvent) document.attachEvent("onerror", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("link"); s.rel = "stylesheet"; s.href = u; f.parentNode.insertBefore(s, f); return s}(new Image()).src = "/_/stat?event=pixel.load&origin=" + encodeURIComponent(location.origin);</script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga("create", "UA-24232453-2", "auto", {"allowLinker": true, "legacyCookieDomain": window.location.hostname}); ga("send", "pageview");ga("create", "UA-65623566-4", "auto", 'tracker0'); ga("tracker0.send", "pageview");</script><script async="" src="./creating_clasifiers_mobilenet_tensorflow_files/analytics.js"></script><!--[if lt IE 9]><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js"></script><![endif]--><link rel="icon" href="https://cdn-images-1.medium.com/fit/c/128/128/1*k81sEnoQeinlKZ0S1NSTtQ.png" class="js-favicon"><link rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/304/304/1*76XiKOa05Yya6_CdYX8pVg.jpeg"><link rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/240/240/1*76XiKOa05Yya6_CdYX8pVg.jpeg"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/152/152/1*76XiKOa05Yya6_CdYX8pVg.jpeg"><link rel="apple-touch-icon" sizes="60x60" href="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/1_76XiKOa05Yya6_CdYX8pVg.jpeg"><link rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(1)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(2)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(3)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(4)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(5)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(6)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(7)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(8)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(9)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(10)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(11)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(12)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(13)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(14)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(15)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(16)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(17)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(18)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(19)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(20)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(21)"></script><style id="__web-inspector-hide-shortcut-style__" type="text/css">
.__web-inspector-hide-shortcut__, .__web-inspector-hide-shortcut__ *, .__web-inspector-hidebefore-shortcut__::before, .__web-inspector-hideafter-shortcut__::after
{
    visibility: hidden !important;
}
</style><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(22)"></script><script src="file:///mnt/3E0CAB3B0CAAECD9/NMS/PROGRAMACION%20NMS/Object_Detection_Tests/Mobilenet_Guide/test2_files/saved_resource(23)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(1)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(2)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(3)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(4)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(5)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(6)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(7)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(8)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(9)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(10)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(11)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(12)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(13)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(14)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(15)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(16)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(17)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(18)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(19)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(20)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(21)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(22)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(23)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(24)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(25)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(26)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(27)"></script><script src="./creating_clasifiers_mobilenet_tensorflow_files/saved_resource(28)"></script></head><body itemscope="" class="postShowScreen browser-chrome is-withMagicUnderlines v-glyph v-glyph--m2 is-js" data-action-scope="_actionscope_0"><div class="site-main surface-container" id="container"><div class="butterBar butterBar--error" data-action-scope="_actionscope_1"></div><div class="surface" id="_obv.shell._surface_1550152510611" style="display: block; visibility: visible;"><div class="screenContent surface-content is-supplementalPostContentLoaded" data-used="true" data-action-scope="_actionscope_2"><canvas class="canvas-renderer" width="1351" height="647"></canvas><div class="container u-maxWidth740 u-xs-margin0 notesPositionContainer js-notesPositionContainer __web-inspector-hide-shortcut__"><div class="notesMarkers" data-action-scope="_actionscope_4"><div class="paragraphControls js-paragraphControl js-paragraphControl-b1c5 u-noUserSelect is-visible" style="top: 2407px;"><span class="paragraphControls-itemText"><button class="button button--chromeless" data-action="select-anchor" data-action-value="b1c5">Top highlight</button></span></div></div></div><main role="main"><article class=" u-minHeight100vhOffset65 u-overflowHidden postArticle postArticle--full is-withAccentColors u-marginBottom40" lang="en"><div class="postArticle-content js-postField js-notesSource js-trackPostScrolls" data-post-id="f030ce0a2991" data-source="post_page" data-collection-id="3a8144eabfe3" data-tracking-context="postPage" data-scroll="native"><section name="23cb" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h1 name="7cc6" id="7cc6" class="graf graf--h3 graf--leading graf--title">Creating insanely fast image classifiers with MobileNet in TensorFlow</h1><h2 name="8d90" id="8d90" class="graf graf--h4 graf--startsWithDoubleQuote graf-after--h3 graf--subtitle">“It’s like hot dog not hot dog, but for&nbsp;roads.”</h2><div class="uiScale uiScale-ui--regular uiScale-caption--regular u-flexCenter u-marginVertical24 u-fontSize15 js-postMetaLockup"><div class="u-flex0"><a class="link u-baseColor--link avatar" href="https://hackernoon.com/@harvitronix?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="58288d309a98" data-action-type="hover" data-user-id="58288d309a98" data-collection-slug="hacker-daily" dir="auto"><img src="./creating_clasifiers_mobilenet_tensorflow_files/0_Evtdzf88V-3nCNbi.jpeg" class="avatar-image u-size50x50" alt="Go to the profile of Matt Harvey"></a></div><div class="u-flex1 u-paddingLeft15 u-overflowHidden"><div class="u-paddingBottom3"><a class="ds-link ds-link--styleSubtle ui-captionStrong u-inlineBlock link link--darken link--darker" href="https://hackernoon.com/@harvitronix" data-action="show-user-card" data-action-value="58288d309a98" data-action-type="hover" data-user-id="58288d309a98" data-collection-slug="hacker-daily" dir="auto">Matt Harvey</a><span class="followState js-followState" data-user-id="58288d309a98"><button class="button button--smallest u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-xs-hide" data-action="sign-up-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-redirect="https://hackernoon.com/creating-insanely-fast-image-classifiers-with-mobilenet-in-tensorflow-f030ce0a2991" data-action-source="post_header_lockup"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--smallest button--dark u-noUserSelect button--withChrome u-accentColor--buttonDark button--follow js-followButton u-marginLeft10 u-xs-hide" data-action="sign-up-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/58288d309a98" data-action-source="post_header_lockup-58288d309a98-------------------------follow_byline"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="ui-caption u-noWrapWithEllipsis js-testPostMetaInlineSupplemental"><time datetime="2017-07-11T15:43:15.513Z">Jul 11, 2017</time><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="8 min read"></span></div></div></div><p name="1f76" id="1f76" class="graf graf--p graf-after--h4">MobileNets are a new family of convolutional neural networks that are set to blow your mind, and today we’re going to train one on a custom dataset.</p><p name="32bf" id="32bf" class="graf graf--p graf-after--p">There are a few things that make MobileNets awesome:</p><ol class="postList"><li name="92f4" id="92f4" class="graf graf--li graf-after--p">They’re insanely small</li><li name="af09" id="af09" class="graf graf--li graf-after--li">They’re insanely fast</li><li name="ea61" id="ea61" class="graf graf--li graf-after--li">They’re remarkably accurate</li><li name="75e0" id="75e0" class="graf graf--li graf-after--li">They’re easy to tune for resources vs. accuracy</li></ol><p name="0f05" id="0f05" class="graf graf--p graf-after--li">Why is this important? Many mobile deep learning tasks are actually performed in the cloud. When you want to classify an image, that image is sent to a web service, it’s classified on a remote server, and the result is sent back to your phone.</p><p name="96ed" id="96ed" class="graf graf--p graf-after--p">That’s changing quickly. The computational power on your phone is increasing rapidly, and the network complexity required for computer vision is shrinking (thanks to architectures like SqueezeNet and MobileNet).</p><p name="0e70" id="0e70" class="graf graf--p graf-after--p">Besides the clear benefit of AI without an internet connection, sending images to the cloud is impractical in speed-hungry situations, like in the vehicle safety apps we’re developing at <a href="http://coast.ai/" data-href="http://coast.ai" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Coastline</a>.</p><p name="3681" id="3681" class="graf graf--p graf-after--p">With that, let’s learn the following:</p><ul class="postList"><li name="93b4" id="93b4" class="graf graf--li graf-after--p">What are MobileNets?</li><li name="85c3" id="85c3" class="graf graf--li graf-after--li">How to build a custom dataset to train a MobileNet with TensorFlow</li><li name="0a3f" id="0a3f" class="graf graf--li graf-after--li">How to train a MobileNet that’s pretrained on ImageNet with TensorFlow</li><li name="3a98" id="3a98" class="graf graf--li graf-after--li">How MobileNets perform against Inception V3</li><li name="c81d" id="c81d" class="graf graf--li graf-after--li">How to use your retrained MobileNet to classify images</li></ul><figure name="238a" id="238a" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 303px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 43.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*ABXyqKiGauuI-GXukp5QFw.jpeg" data-width="960" data-height="416" data-is-featured="true" data-action="zoom" data-action-value="1*ABXyqKiGauuI-GXukp5QFw.jpeg" data-scroll="native"><img src="./creating_clasifiers_mobilenet_tensorflow_files/1_ABXyqKiGauuI-GXukp5QFw.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="32"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*ABXyqKiGauuI-GXukp5QFw.jpeg" src="./creating_clasifiers_mobilenet_tensorflow_files/1_ABXyqKiGauuI-GXukp5QFw(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*ABXyqKiGauuI-GXukp5QFw.jpeg"></noscript></div></div><figcaption class="imageCaption">We’ll use MobileNets to build a road, not road classifer to identify images like this&nbsp;one.</figcaption></figure><h3 name="74ea" id="74ea" class="graf graf--h3 graf-after--figure">What are MobileNets?</h3><p name="e567" id="e567" class="graf graf--p graf-after--h3">MobileNets are a class of convolutional neural network designed by researches at Google. They are coined “mobile-first” in that they’re architected from the ground up to be resource-friendly and run quickly, right on your phone.</p><p name="e479" id="e479" class="graf graf--p graf-after--p">The main difference between the MobileNet architecture and a “traditional” CNN’s is instead of a single 3x3 convolution layer followed by batch norm and ReLU, MobileNets split the convolution into a 3x3 depthwise conv and a 1x1 pointwise conv. The details of why this is so significant can be found in the <a href="https://arxiv.org/pdf/1704.04861.pdf" data-href="https://arxiv.org/pdf/1704.04861.pdf" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">MobileNet paper</a>, which I strongly encourage you to read.</p><p name="b323" id="b323" class="graf graf--p graf-after--p">So what’s the catch? Accuracy. MobileNets are not usually as accurate as the bigger, more resource-intensive networks we’ve come to know and love. But finding that resource/accuracy trade-off is where MobileNets really shine.</p><p name="b1c5" id="b1c5" class="graf graf--p graf-after--p"><span class="markup--quote markup--p-quote is-other" name="anon_642b4f7d7d9e" data-creator-ids="anon">MobileNets surface two parameters that we can tune to fit the resource/accuracy trade-off of our exact problem: width multiplier and resolution multiplier.</span> The width multiplier allows us to thin the network, while the resolution multiplier changes the input dimensions of the image, reducing the internal representation at every layer.</p><p name="aa08" id="aa08" class="graf graf--p graf-after--p">Google <a href="https://research.googleblog.com/2017/06/mobilenets-open-source-models-for.html" data-href="https://research.googleblog.com/2017/06/mobilenets-open-source-models-for.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">open-sourced the MobileNet architecture</a> and released 16 ImageNet checkpoints, each corresponding to a different parameter configuration. This gives us an excellent starting point for training our own classifiers that are <em class="markup--em markup--p-em">insanely</em> small and <em class="markup--em markup--p-em">insanely</em> fast.</p><p name="bc89" id="bc89" class="graf graf--p graf-after--p"><em class="markup--em markup--p-em">To learn more about how MobileNets work, read</em><a href="https://arxiv.org/pdf/1704.04861.pdf" data-href="https://arxiv.org/pdf/1704.04861.pdf" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><em class="markup--em markup--p-em"> MobileNets: Efficient Convolutional Neural Networks for Mobile Vision Applications</em></a><em class="markup--em markup--p-em">.</em></p><h3 name="14df" id="14df" class="graf graf--h3 graf-after--p">How to build your own dataset to train a MobileNet</h3><p name="f6b2" id="f6b2" class="graf graf--p graf-after--h3">Our challenge today is to build an image classifier that can detect if an image is a road or not a road. It’s like <a href="https://www.youtube.com/watch?v=ACmydtFDTGs" data-href="https://www.youtube.com/watch?v=ACmydtFDTGs" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">hot dog, not hot dog</a>, but for roads.</p><p name="445e" id="445e" class="graf graf--p graf-after--p">Why road, not road? At <a href="https://coast.ai/" data-href="https://coast.ai" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Coastline</a>, we’re developing safety features for your car with mobile apps that use computer vision. As with all vision problems, user privacy is critical. So one of the first checks we do when a user turns on the camera in our app is check if it sees a road. If it doesn’t, we turn off the camera. We want to be able to do this fast and at as little computational cost to the user as possible.</p><p name="f8b4" id="f8b4" class="graf graf--p graf-after--p">Since we’re tackling a custom problem, we need to start with creating our dataset. Our target is to collect 10,000 images, split roughly evenly 50/50 road/not road.</p><p name="e053" id="e053" class="graf graf--p graf-after--p">We’ll get data from a few different places:</p><ul class="postList"><li name="8862" id="8862" class="graf graf--li graf-after--p">4,000 obviously road images sampled randomly from the Coastline driving dataset</li><li name="3984" id="3984" class="graf graf--li graf-after--li">2,000 obviously not road images sampled randomly from the ImageNet dataset</li><li name="7aa7" id="7aa7" class="graf graf--li graf-after--li">3,000 less obviously not road scenics sampled from the internet to make sure the classifier doesn’t just learn sky, not sky</li><li name="411a" id="411a" class="graf graf--li graf-after--li">1,000 less obviously road scenics also sampled from the internet to make sure the classifier doesn’t recognize windshield reflections or other commonalities in the Coastline data</li></ul><p name="460e" id="460e" class="graf graf--p graf-after--li">We’ll place each image into one of two folders, each representing the class of that image: <code class="markup--code markup--p-code">road</code> and <code class="markup--code markup--p-code">not-road</code>. That’s all we have to do to prepare our images for retraining!</p><p name="6a6d" id="6a6d" class="graf graf--p graf-after--p">However, while grabbing <a href="https://search.creativecommons.org/" data-href="https://search.creativecommons.org/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">CC images</a> from the internet is a great place to add diversity to your dataset, it comes with a drawback: the labels are noisy. For instance, an image found by searching “road landscape” could have a road front and center with a nice scene in the background, or it could be a mountain scene with a tiny road off in the distance.</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="ac0d" id="ac0d" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 50.033%;" data-scroll="native"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.5%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*rLaaBLfAW4KhpsDlq4oa-w.jpeg" data-width="3008" data-height="2000" data-action="zoom" data-action-value="1*rLaaBLfAW4KhpsDlq4oa-w.jpeg" data-scroll="native"><img src="./creating_clasifiers_mobilenet_tensorflow_files/1_rLaaBLfAW4KhpsDlq4oa-w.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="48"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*rLaaBLfAW4KhpsDlq4oa-w.jpeg" src="./creating_clasifiers_mobilenet_tensorflow_files/1_rLaaBLfAW4KhpsDlq4oa-w(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*rLaaBLfAW4KhpsDlq4oa-w.jpeg"></noscript></div></div></figure><figure name="a2bb" id="a2bb" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 49.967%;" data-scroll="native"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.60000000000001%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*IS6ATUFFompAyj5fsq4VYQ.jpeg" data-width="4928" data-height="3280" data-action="zoom" data-action-value="1*IS6ATUFFompAyj5fsq4VYQ.jpeg" data-scroll="native"><img src="./creating_clasifiers_mobilenet_tensorflow_files/1_IS6ATUFFompAyj5fsq4VYQ.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="48"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*IS6ATUFFompAyj5fsq4VYQ.jpeg" src="./creating_clasifiers_mobilenet_tensorflow_files/1_IS6ATUFFompAyj5fsq4VYQ(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*IS6ATUFFompAyj5fsq4VYQ.jpeg"></noscript></div></div><figcaption class="imageCaption" style="width: 200.132%; left: -100.132%;">Two images both labeled “road”. For our problem, the first should be “not road” and the second should be “road”. Left: <a href="https://www.flickr.com/photos/82036561@N00/7524452224" data-href="https://www.flickr.com/photos/82036561@N00/7524452224" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">“Scenic Mountain Road”</a> by <a href="https://www.flickr.com/people/82036561@N00/" data-href="https://www.flickr.com/people/82036561@N00/" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank"><em class="markup--em markup--figure-em">Tyler Thompson</em></a><em class="markup--em markup--figure-em"> </em>is licensed under <a href="https://creativecommons.org/licenses/by/2.0" data-href="https://creativecommons.org/licenses/by/2.0" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">CC BY 2.0</a> Right: <a href="https://www.flickr.com/photos/zionfiction/21808267691" data-href="https://www.flickr.com/photos/zionfiction/21808267691" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">“150927-road-scenic-bypass-mountains.jpg”</a> by <a href="https://www.flickr.com/people/zionfiction/" data-href="https://www.flickr.com/people/zionfiction/" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank"><em class="markup--em markup--figure-em">r. nial bradshaw</em></a><em class="markup--em markup--figure-em"> </em>is licensed under <a href="https://creativecommons.org/licenses/by/2.0" data-href="https://creativecommons.org/licenses/by/2.0" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">CC BY&nbsp;2.0</a></figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="9b2c" id="9b2c" class="graf graf--p graf-after--figure">We could solve for this by going through each image and hand-labeling it, but why do that when we have deep learning?! Instead, we retrain a big network (like Inception V3) on all our data, paying special attention not to over-fit on our training data by early stopping and heavy data augmentation. Then we run every image of our dataset (even those images we just used to train!) through the network and keep track of the images it classified incorrectly or with little confidence. Then we go through each of those images and move them to their proper classes, if applicable. This reduces the number of images we have to manually clean up significantly. And doing multiple passes of this technique helped us increase our accuracy by seven percentage points on Inception.</p><p name="d0b2" id="d0b2" class="graf graf--p graf-after--p">Now that we have 5,000 road images and 5,000 not road images, in a structure like this…</p><pre name="f4d0" id="f4d0" class="graf graf--pre graf-after--p">data/<br>  road/[images...]<br>  not-road/[images...]</pre><p name="45d5" id="45d5" class="graf graf--p graf-after--pre">…we’ll use TensorFlow and transfer learning to fine-tune MobileNets on our custom dataset.</p><h3 name="ba8c" id="ba8c" class="graf graf--h3 graf-after--p">How to retrain a MobileNet that’s pretrained on&nbsp;ImageNet</h3><p name="7174" id="7174" class="graf graf--p graf-after--h3">TensorFlow comes packaged with great tools that you can use to retrain MobileNets without having to actually write any code. This stuff is fresh off the presses: Retraining support for MobileNet was <a href="https://github.com/tensorflow/tensorflow/commit/055500bbcea60513c0160d213a10a7055f079312" data-href="https://github.com/tensorflow/tensorflow/commit/055500bbcea60513c0160d213a10a7055f079312" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">added less than a week ago</a>!</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="d33d" id="d33d" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 50%;" data-scroll="native"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*RHlMa6yGVMvx82uhf73PxQ.jpeg" data-width="640" data-height="480" data-action="zoom" data-action-value="1*RHlMa6yGVMvx82uhf73PxQ.jpeg" data-scroll="native"><img src="./creating_clasifiers_mobilenet_tensorflow_files/1_RHlMa6yGVMvx82uhf73PxQ.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="56"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*RHlMa6yGVMvx82uhf73PxQ.jpeg" src="./creating_clasifiers_mobilenet_tensorflow_files/1_RHlMa6yGVMvx82uhf73PxQ(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*RHlMa6yGVMvx82uhf73PxQ.jpeg"></noscript></div></div></figure><figure name="fbe7" id="fbe7" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 50%;" data-scroll="native"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*ljUcKVNqW2qQ4_vGc5Icwg.jpeg" data-width="640" data-height="480" data-action="zoom" data-action-value="1*ljUcKVNqW2qQ4_vGc5Icwg.jpeg" data-scroll="native"><img src="./creating_clasifiers_mobilenet_tensorflow_files/1_ljUcKVNqW2qQ4_vGc5Icwg.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="56"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*ljUcKVNqW2qQ4_vGc5Icwg.jpeg" src="./creating_clasifiers_mobilenet_tensorflow_files/1_ljUcKVNqW2qQ4_vGc5Icwg(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*ljUcKVNqW2qQ4_vGc5Icwg.jpeg"></noscript></div></div><figcaption class="imageCaption" style="width: 200%; left: -100%;">A couple very obviously road images from the Coastline dataset.</figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="b9c7" id="b9c7" class="graf graf--p graf-after--figure">If you don’t have it downloaded already, fork and/or clone the TensorFlow repo:</p><pre name="25a2" id="25a2" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">git clone https://github.com/tensorflow/tensorflow.git</code></pre><p name="6501" id="6501" class="graf graf--p graf-after--pre">Now you can use the scripts in the example folder to retrain MobileNet on your own data.</p><p name="c89f" id="c89f" class="graf graf--p graf-after--p">But wait! Which MobileNet should you use? That’s a good question. Let’s retrain a small assortment and see how they perform. To kick off training, we’ll run the following command from the root of the TensorFlow repo:</p><pre name="a88a" id="a88a" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">python tensorflow/examples/image_retraining/retrain.py \<br>    --image_dir ~/ml/blogs/road-not-road/data/ \<br>    --learning_rate=0.0001 \<br>    --testing_percentage=20 \<br>    --validation_percentage=20 \<br>    --train_batch_size=32 \<br>    --validation_batch_size=-1 \<br>    --flip_left_right True \<br>    --random_scale=30 \<br>    --random_brightness=30 \<br>    --eval_step_interval=100 \<br>    --how_many_training_steps=600 \<br>    --architecture mobilenet_1.0_224</code></pre><p name="dcd6" id="dcd6" class="graf graf--p graf-after--pre">The <code class="markup--code markup--p-code">architecture</code> flag is where we tell the retraining script which version of MobileNet we want to use. The 1.0 corresponds to the width multiplier, and can be 1.0, 0.75, 0.50 or 0.25. The 224 corresponds to image resolution, and can be 224, 192, 160 or 128. For example, to train the smallest version, you’d use <code class="markup--code markup--p-code">--architecture mobilenet_0.25_128</code>.</p><p name="46ca" id="46ca" class="graf graf--p graf-after--p">Some other important parameters:</p><ul class="postList"><li name="f84d" id="f84d" class="graf graf--li graf-after--p">learning_rate: This is something you’ll want to play with. I found 0.0001 to work well.</li><li name="e9f6" id="e9f6" class="graf graf--li graf-after--li">testing and validation percentage: The script will split your data into train/val/test for you. It will use train to train, val to give performance updates every “eval_step_interval”, and test will run after “how_many_training_steps” to give you your final score.</li><li name="82b6" id="82b6" class="graf graf--li graf-after--li">validation_batch_size: Setting this to -1 tells the script to use all your data to validate on. When you don’t have a lot of data (like only 10,000 images), it’s a good idea to use -1 here to reduce variance between evaluation steps.</li></ul><p name="c087" id="c087" class="graf graf--p graf-after--li">After retraining on several model architectures, let’s see how they compare.</p><h3 name="a833" id="a833" class="graf graf--h3 graf-after--p">Comparing MobileNet parameters and their performance against Inception</h3><p name="12d2" id="12d2" class="graf graf--p graf-after--h3">After just 600 steps on training Inception to get a baseline (by setting the <code class="markup--code markup--p-code">— architecture</code> flag to <code class="markup--code markup--p-code">inception_v3)</code>, we hit 95.9%. Training took 18 minutes. (There is a lot of room for improvement here, but we don’t have all day!) The resulting checkpoint landed at 84mb. And doing a quick speed test by running 1,000 images through it shows it can classify images on an NVIDIA GeForce 960m GPU at ~19fps.</p><p name="8524" id="8524" class="graf graf--p graf-after--p"><em class="markup--em markup--p-em">Aside: Why “only” 95.9% and not 100%? It seems like a pretty simple problem, right? Well, besides the ample tuning we could do to the training parameters (we actually achieved 98.9% with the same data using a different configuration in another go), it turns out the distinction between classes is a bit more subtle than it seems on the surface. Take these cases:</em></p><ul class="postList"><li name="1b5a" id="1b5a" class="graf graf--li graf-after--p"><em class="markup--em markup--li-em">The image is a one-lane dirt road in the woods: Is it a road or a trail? I don’t even know.</em></li><li name="5888" id="5888" class="graf graf--li graf-after--li"><em class="markup--em markup--li-em">It’s a landscape scenic with a road in the distance. Is it a picture or a road, or is there just a road in the picture? At what point does the scenic move classes?</em></li><li name="baec" id="baec" class="graf graf--li graf-after--li"><em class="markup--em markup--li-em">It’s an artsy tilt-shift photo of a couple holding hands in the foreground and a time-lapsed street in the background. Road or not road? Flip a coin.</em></li></ul><p name="931e" id="931e" class="graf graf--p graf-after--li">So, how do the MobileNets perform? Not surprisingly, not quite as well. However, the tradeoff benefit is <em class="markup--em markup--p-em">astounding</em>.</p><p name="8877" id="8877" class="graf graf--p graf-after--p">Using the biggest MobileNet (1.0, 224), we were able to achieve 95.5% accuracy with just 4 minutes of training. The resulting model size was just 17mb, and it can run on the same GPU at ~135fps.</p><p name="cf62" id="cf62" class="graf graf--p graf-after--p">For those keeping score, that’s <strong class="markup--strong markup--p-strong">7 times faster and a quarter the size</strong>. All for just 0.4% loss in accuracy.</p><figure name="b15a" id="b15a" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 233px; max-height: 250px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 107.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*BQLT4rq8Upbb8-Nkhr9VcA.gif" data-width="233" data-height="250" data-scroll="native"><img src="./creating_clasifiers_mobilenet_tensorflow_files/1_BQLT4rq8Upbb8-Nkhr9VcA.gif" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="70" height="75"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*BQLT4rq8Upbb8-Nkhr9VcA.gif" src="./creating_clasifiers_mobilenet_tensorflow_files/1_BQLT4rq8Upbb8-Nkhr9VcA(1).gif"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*BQLT4rq8Upbb8-Nkhr9VcA.gif"></noscript></div></div></figure><p name="4a1b" id="4a1b" class="graf graf--p graf-after--figure">How about the smallest MobileNet (0.24, 128), using quantized weights? Big accuracy tradeoff, achieving just 89.2%. But get this: 450 frames per second, and the model takes just 930kb of memory. That’s kilobytes!</p><figure name="7a20" id="7a20" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 320px; max-height: 320px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*QLsdeD8P1X19mIFLA734ww.gif" data-width="320" data-height="320" data-scroll="native"><img src="./creating_clasifiers_mobilenet_tensorflow_files/1_QLsdeD8P1X19mIFLA734ww.gif" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*QLsdeD8P1X19mIFLA734ww.gif" src="./creating_clasifiers_mobilenet_tensorflow_files/1_QLsdeD8P1X19mIFLA734ww(1).gif"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*QLsdeD8P1X19mIFLA734ww.gif"></noscript></div></div></figure><h3 name="f2c5" id="f2c5" class="graf graf--h3 graf-after--figure">Using your retrained MobileNet to classify&nbsp;images</h3><p name="acce" id="acce" class="graf graf--p graf-after--h3">Now that you have your MobileNet retrained on your custom dataset, it’s time to give it a try. Not surprisingly, TensorFlow comes with a script to do that, too.</p><pre name="628c" id="628c" class="graf graf--pre graf-after--p">python3 tensorflow/examples/label_image/label_image.py \ <br>  --graph=/tmp/mobilenet_0.50_192.pb \<br>  --labels=/tmp/output_labels.txt \<br>  --image=/home/harvitronix/ml/blogs/road-not-road/test-image.jpg \<br>  --input_layer=input \<br>  --output_layer=final_result \<br>  --input_mean=128 \<br>  --input_std=128 \<br>  --input_width=192 \<br>  --input_height=192</pre><figure name="c814" id="c814" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 525px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*lTLV8TNU4w4ABi2QMbF7Pw.jpeg" data-width="960" data-height="720" data-action="zoom" data-action-value="1*lTLV8TNU4w4ABi2QMbF7Pw.jpeg" data-scroll="native"><img src="./creating_clasifiers_mobilenet_tensorflow_files/1_lTLV8TNU4w4ABi2QMbF7Pw.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="56"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*lTLV8TNU4w4ABi2QMbF7Pw.jpeg" src="./creating_clasifiers_mobilenet_tensorflow_files/1_lTLV8TNU4w4ABi2QMbF7Pw(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*lTLV8TNU4w4ABi2QMbF7Pw.jpeg"></noscript></div></div><figcaption class="imageCaption">Our network classifies this as road, with confidence of 0.686811. Not too confidence, but hey, that’s a FAST&nbsp;road!</figcaption></figure><p name="fc52" id="fc52" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">Aside: It should be noted that in our fairly simple two-class problem, the accuracy trade-off is not that big. In the case of ImageNet with its 1,001 classes, the accuracy tradeoffs are much more significant. See </em><a href="https://research.googleblog.com/2017/06/mobilenets-open-source-models-for.html" data-href="https://research.googleblog.com/2017/06/mobilenets-open-source-models-for.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><em class="markup--em markup--p-em">the table here</em></a><em class="markup--em markup--p-em">.</em></p><h3 name="cab0" id="cab0" class="graf graf--h3 graf-after--p">Next steps</h3><p name="120e" id="120e" class="graf graf--p graf-after--h3">Okay, so the whole point of MobileNets is to run on mobile, right? Stay tuned! In our next post, we’ll create some purpose-built training data, fine-tune again, and load our retrained MobileNet into an Android app. We’ll see how fast it can run on a mobile device and how accurate it is in the real world.</p><blockquote name="b619" id="b619" class="graf graf--blockquote graf-after--p graf--trailing"><em class="markup--em markup--blockquote-em">UPDATE</em>: Part 2 is now live! Don’t miss <a href="https://hackernoon.com/building-an-insanely-fast-image-classifier-on-android-with-mobilenets-in-tensorflow-dc3e0c4410d4" data-href="https://hackernoon.com/building-an-insanely-fast-image-classifier-on-android-with-mobilenets-in-tensorflow-dc3e0c4410d4" class="markup--anchor markup--blockquote-anchor" target="_blank">Building an insanely fast image classifier on Android with MobileNets in TensorFlow</a>.</blockquote></div></div></section></div></article></main><style class="js-collectionStyle">
.u-accentColor--borderLight {border-color: #00A600 !important;}
.u-accentColor--borderNormal {border-color: #00A600 !important;}
.u-accentColor--borderDark {border-color: #008E00 !important;}
.u-accentColor--iconLight .svgIcon,.u-accentColor--iconLight.svgIcon {fill: #00A600 !important;}
.u-accentColor--iconNormal .svgIcon,.u-accentColor--iconNormal.svgIcon {fill: #00A600 !important;}
.u-accentColor--iconDark .svgIcon,.u-accentColor--iconDark.svgIcon {fill: #008E00 !important;}
.u-accentColor--textNormal {color: #008E00 !important;}
.u-accentColor--hoverTextNormal:hover {color: #008E00 !important;}
.u-accentColor--textNormal.u-accentColor--textDarken:hover {color: #008100 !important;}
.u-accentColor--textDark {color: #008100 !important;}
.u-accentColor--backgroundLight {background-color: #00A600 !important;}
.u-accentColor--backgroundNormal {background-color: #00A600 !important;}
.u-accentColor--backgroundDark {background-color: #008E00 !important;}
.u-accentColor--buttonDark {border-color: #008E00 !important; color: #008100 !important;}
.u-accentColor--buttonDark:hover {border-color: #008100 !important;}
.u-accentColor--buttonDark .icon:before,.u-accentColor--buttonDark .svgIcon{color: #008E00 !important; fill: #008E00 !important;}
.u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: #00A600 !important; color: #008E00 !important;}
.u-accentColor--buttonNormal:hover {border-color: #008E00 !important;}
.u-accentColor--buttonNormal .icon:before,.u-accentColor--buttonNormal .svgIcon{color: #00A600 !important; fill: #00A600 !important;}
.u-accentColor--buttonNormal.button--filled .icon:before,.u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-accentColor--buttonDark.button--filled,.u-accentColor--buttonDark.button--withChrome.is-active,.u-accentColor--fillWhenActive.is-active {background-color: #008E00 !important; border-color: #008E00 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: #00A600 !important; border-color: #00A600 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.postArticle.is-withAccentColors .markup--user,.postArticle.is-withAccentColors .markup--query {color: #008E00 !important;}.u-tintBgColor {background-color: rgba(0, 255, 0, 1) !important;}.u-tintBgColor .u-fadeLeft:before {background-image: linear-gradient(to right, rgba(0, 255, 0, 1) 0%, rgba(0, 255, 0, 0) 100%) !important;}.u-tintBgColor .u-fadeRight:after {background-image: linear-gradient(to right, rgba(0, 255, 0, 0) 0%, rgba(0, 255, 0, 1) 100%) !important;}
.u-tintSpectrum .u-baseColor--borderLight {border-color: #00B400 !important;}
.u-tintSpectrum .u-baseColor--borderNormal {border-color: #009200 !important;}
.u-tintSpectrum .u-baseColor--borderDark {border-color: #006D00 !important;}
.u-tintSpectrum .u-baseColor--iconLight .svgIcon,.u-tintSpectrum .u-baseColor--iconLight.svgIcon {fill: #00B400 !important;}
.u-tintSpectrum .u-baseColor--iconNormal .svgIcon,.u-tintSpectrum .u-baseColor--iconNormal.svgIcon {fill: #009200 !important;}
.u-tintSpectrum .u-baseColor--iconDark .svgIcon,.u-tintSpectrum .u-baseColor--iconDark.svgIcon {fill: #006D00 !important;}
.u-tintSpectrum .u-baseColor--textNormal {color: #009200 !important;}
.u-tintSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: #005900 !important;}
.u-tintSpectrum .u-baseColor--textDark {color: #005900 !important;}
.u-tintSpectrum .u-baseColor--textDarker {color: #005900 !important;}
.u-tintSpectrum .u-baseColor--backgroundLight {background-color: #00B400 !important;}
.u-tintSpectrum .u-baseColor--backgroundNormal {background-color: #009200 !important;}
.u-tintSpectrum .u-baseColor--backgroundDark {background-color: #006D00 !important;}
.u-tintSpectrum .u-baseColor--buttonLight {border-color: #00B400 !important; color: #00B400 !important;}
.u-tintSpectrum .u-baseColor--buttonLight:hover {border-color: #00B400 !important;}
.u-tintSpectrum .u-baseColor--buttonLight .icon:before,.u-tintSpectrum .u-baseColor--buttonLight .svgIcon {color: #00B400 !important; fill: #00B400 !important;}
.u-tintSpectrum .u-baseColor--buttonDark {border-color: #006D00 !important; color: #005900 !important;}
.u-tintSpectrum .u-baseColor--buttonDark:hover {border-color: #005900 !important;}
.u-tintSpectrum .u-baseColor--buttonDark .icon:before,.u-tintSpectrum .u-baseColor--buttonDark .svgIcon {color: #006D00 !important; fill: #006D00 !important;}
.u-tintSpectrum .u-baseColor--buttonNormal {border-color: #009200 !important; color: #009200 !important;}
.u-tintSpectrum .u-baseColor--buttonNormal:hover {border-color: #006D00 !important;}
.u-tintSpectrum .u-baseColor--buttonNormal .icon:before,.u-tintSpectrum .u-baseColor--buttonNormal .svgIcon {color: #009200 !important; fill: #009200 !important;}
.u-tintSpectrum .u-baseColor--buttonDark.button--filled,.u-tintSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: #006D00 !important; border-color: #006D00 !important; color: rgba(0, 255, 0, 1) !important; fill: rgba(0, 255, 0, 1) !important;}
.u-tintSpectrum .u-baseColor--buttonNormal.button--filled,.u-tintSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: #009200 !important; border-color: #009200 !important; color: rgba(0, 255, 0, 1) !important; fill: rgba(0, 255, 0, 1) !important;}
.u-tintSpectrum .u-baseColor--link {color: #009200 !important;}
.u-tintSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: #005900 !important;}
.u-tintSpectrum .u-baseColor--link.link--darken:hover,.u-tintSpectrum .u-baseColor--link.link--darken:focus,.u-tintSpectrum .u-baseColor--link.link--darken:active {color: #005900 !important;}
.u-tintSpectrum .u-baseColor--link.link--dark {color: #005900 !important;}
.u-tintSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-tintSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-tintSpectrum .u-baseColor--link.link--dark.link--darken:active {color: #005900 !important;}
.u-tintSpectrum .u-baseColor--link.link--darker {color: #005900 !important;}
.u-tintSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: #00B400;}
.u-tintSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: #00B400;}
.u-tintSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: #00B400;}
.u-tintSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: #005900 !important;}
.u-tintSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: #005900 !important;}
.u-tintSpectrum  .ui-h1,.u-tintSpectrum  .ui-h2,.u-tintSpectrum  .ui-h3,.u-tintSpectrum  .ui-h4,.u-tintSpectrum  .ui-brand1,.u-tintSpectrum  .ui-brand2,.u-tintSpectrum  .ui-captionStrong {color: #005900 !important; fill: #005900 !important;}
.u-tintSpectrum  .ui-body,.u-tintSpectrum  .ui-caps {color: #005900 !important; fill: #005900 !important;}
.u-tintSpectrum  .ui-summary,.u-tintSpectrum  .ui-caption {color: #00B400 !important; fill: #00B400 !important;}
.u-tintSpectrum .u-accentColor--borderLight {border-color: #00B400 !important;}
.u-tintSpectrum .u-accentColor--borderNormal {border-color: #009200 !important;}
.u-tintSpectrum .u-accentColor--borderDark {border-color: #006D00 !important;}
.u-tintSpectrum .u-accentColor--iconLight .svgIcon,.u-tintSpectrum .u-accentColor--iconLight.svgIcon {fill: #00B400 !important;}
.u-tintSpectrum .u-accentColor--iconNormal .svgIcon,.u-tintSpectrum .u-accentColor--iconNormal.svgIcon {fill: #009200 !important;}
.u-tintSpectrum .u-accentColor--iconDark .svgIcon,.u-tintSpectrum .u-accentColor--iconDark.svgIcon {fill: #006D00 !important;}
.u-tintSpectrum .u-accentColor--textNormal {color: #009200 !important;}
.u-tintSpectrum .u-accentColor--hoverTextNormal:hover {color: #009200 !important;}
.u-tintSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: #005900 !important;}
.u-tintSpectrum .u-accentColor--textDark {color: #005900 !important;}
.u-tintSpectrum .u-accentColor--backgroundLight {background-color: #00B400 !important;}
.u-tintSpectrum .u-accentColor--backgroundNormal {background-color: #009200 !important;}
.u-tintSpectrum .u-accentColor--backgroundDark {background-color: #006D00 !important;}
.u-tintSpectrum .u-accentColor--buttonDark {border-color: #006D00 !important; color: #005900 !important;}
.u-tintSpectrum .u-accentColor--buttonDark:hover {border-color: #005900 !important;}
.u-tintSpectrum .u-accentColor--buttonDark .icon:before,.u-tintSpectrum .u-accentColor--buttonDark .svgIcon{color: #006D00 !important; fill: #006D00 !important;}
.u-tintSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: #009200 !important; color: #009200 !important;}
.u-tintSpectrum .u-accentColor--buttonNormal:hover {border-color: #006D00 !important;}
.u-tintSpectrum .u-accentColor--buttonNormal .icon:before,.u-tintSpectrum .u-accentColor--buttonNormal .svgIcon{color: #009200 !important; fill: #009200 !important;}
.u-tintSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-tintSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(0, 255, 0, 1) !important; fill: rgba(0, 255, 0, 1) !important;}
.u-tintSpectrum .u-accentColor--buttonDark.button--filled,.u-tintSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-tintSpectrum .u-accentColor--fillWhenActive.is-active {background-color: #006D00 !important; border-color: #006D00 !important; color: rgba(0, 255, 0, 1) !important; fill: rgba(0, 255, 0, 1) !important;}
.u-tintSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-tintSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: #009200 !important; border-color: #009200 !important; color: rgba(0, 255, 0, 1) !important; fill: rgba(0, 255, 0, 1) !important;}
.u-tintSpectrum .postArticle.is-withAccentColors .markup--user,.u-tintSpectrum .postArticle.is-withAccentColors .markup--query {color: #009200 !important;}
.u-accentColor--highlightFaint {background-color: rgba(203, 255, 186, 1) !important;}
.u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(110, 255, 89, 1) !important;}
.postArticle.is-withAccentColors .markup--quote.is-other {background-color: rgba(203, 255, 186, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(203, 255, 186, 1), rgba(203, 255, 186, 1));}
.postArticle.is-withAccentColors .markup--quote.is-me {background-color: rgba(157, 255, 134, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(157, 255, 134, 1), rgba(157, 255, 134, 1));}
.postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: rgba(110, 255, 89, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(110, 255, 89, 1), rgba(110, 255, 89, 1));}
.postArticle.is-withAccentColors .markup--quote.is-selected {background-color: rgba(110, 255, 89, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(110, 255, 89, 1), rgba(110, 255, 89, 1));}
.postArticle.is-withAccentColors .markup--highlight {background-color: rgba(110, 255, 89, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(110, 255, 89, 1), rgba(110, 255, 89, 1));}.u-baseColor--iconNormal.avatar-halo {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}</style><style class="js-collectionStyleConstant">.u-imageBgColor {background-color: rgba(0, 0, 0, 0.24705882352941178);}
.u-imageSpectrum .u-baseColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-baseColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-baseColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--iconLight .svgIcon,.u-imageSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--iconNormal .svgIcon,.u-imageSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--iconDark .svgIcon,.u-imageSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textDark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textDarker {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-baseColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important; color: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-baseColor--buttonLight .icon:before,.u-imageSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonDark .icon:before,.u-imageSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal .icon:before,.u-imageSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonDark.button--filled,.u-imageSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal.button--filled,.u-imageSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-baseColor--link {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--darken:active {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--dark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--darker {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-h1,.u-imageSpectrum  .ui-h2,.u-imageSpectrum  .ui-h3,.u-imageSpectrum  .ui-h4,.u-imageSpectrum  .ui-brand1,.u-imageSpectrum  .ui-brand2,.u-imageSpectrum  .ui-captionStrong {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-body,.u-imageSpectrum  .ui-caps {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-summary,.u-imageSpectrum  .ui-caption {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-accentColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-accentColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-accentColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--iconLight .svgIcon,.u-imageSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-accentColor--iconNormal .svgIcon,.u-imageSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--iconDark .svgIcon,.u-imageSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--textDark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-accentColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark .icon:before,.u-imageSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-accentColor--buttonDark.button--filled,.u-imageSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-imageSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-imageSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .postArticle.is-withAccentColors .markup--user,.u-imageSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--highlightFaint {background-color: rgba(255, 255, 255, 0.2) !important;}
.u-imageSpectrum .u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(255, 255, 255, 0.6) !important;}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: rgba(255, 255, 255, 0.2) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.2));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: rgba(255, 255, 255, 0.4) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.4), rgba(255, 255, 255, 0.4));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}.u-resetSpectrum .u-tintBgColor {background-color: rgba(255, 255, 255, 1) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeLeft:before {background-image: linear-gradient(to right, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0) 100%) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeRight:after {background-image: linear-gradient(to right, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 1) 100%) !important;}
.u-resetSpectrum .u-baseColor--borderLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--borderNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--borderDark {border-color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--iconLight .svgIcon,.u-resetSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--iconNormal .svgIcon,.u-resetSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--iconDark .svgIcon,.u-resetSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textNormal {color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textDark {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textDarker {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--backgroundLight {background-color: rgba(0, 0, 0, 0.09803921568627451) !important;}
.u-resetSpectrum .u-baseColor--backgroundNormal {background-color: rgba(0, 0, 0, 0.2) !important;}
.u-resetSpectrum .u-baseColor--backgroundDark {background-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight .icon:before,.u-resetSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonDark {border-color: rgba(0, 0, 0, 0.6) !important; color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--buttonDark .icon:before,.u-resetSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important; color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal .icon:before,.u-resetSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(0, 0, 0, 0.4980392156862745) !important; fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonDark.button--filled,.u-resetSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2980392156862745) !important; border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal.button--filled,.u-resetSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2) !important; border-color: rgba(0, 0, 0, 0.2) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-baseColor--link {color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--darken:active {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--dark {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--link.link--darker {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum  .ui-h1,.u-resetSpectrum  .ui-h2,.u-resetSpectrum  .ui-h3,.u-resetSpectrum  .ui-h4,.u-resetSpectrum  .ui-brand1,.u-resetSpectrum  .ui-brand2,.u-resetSpectrum  .ui-captionStrong {color: rgba(0, 0, 0, 0.8) !important; fill: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum  .ui-body,.u-resetSpectrum  .ui-caps {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum  .ui-summary,.u-resetSpectrum  .ui-caption {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-accentColor--borderLight {border-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--borderNormal {border-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--borderDark {border-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--iconLight .svgIcon,.u-resetSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--iconNormal .svgIcon,.u-resetSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--iconDark .svgIcon,.u-resetSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--textNormal {color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--textDark {color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundLight {background-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundNormal {background-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundDark {background-color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark {border-color: rgba(0, 171, 107, 1) !important; color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark .icon:before,.u-resetSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(28, 153, 99, 1) !important; fill: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(2, 184, 117, 1) !important; color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(0, 171, 107, 1) !important; fill: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark.button--filled,.u-resetSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-resetSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(28, 153, 99, 1) !important; border-color: rgba(28, 153, 99, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-resetSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(0, 171, 107, 1) !important; border-color: rgba(0, 171, 107, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .postArticle.is-withAccentColors .markup--user,.u-resetSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(0, 171, 107, 1) !important;}</style><div class="highlightMenu" data-action-scope="_actionscope_3" style="left: 437px; top: 8979px;"><div class="highlightMenu-inner"><div class="buttonSet"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu u-accentColor--highlightStrong js-highlightMenuQuoteButton" data-action="sign-up-prompt" data-sign-in-action="quote" data-requires-token="true" data-skip-onboarding="true" data-redirect-type="quote" data-action-source="quote_menu--------------------------highlight_text"><span class="svgIcon svgIcon--highlighter svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M13.7 15.964l5.204-9.387-4.726-2.62-5.204 9.387 4.726 2.62zm-.493.885l-1.313 2.37-1.252.54-.702 1.263-3.796-.865 1.228-2.213-.202-1.35 1.314-2.37 4.722 2.616z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="sign-up-prompt" data-sign-in-action="quote-respond" data-redirect="https://hackernoon.com/creating-insanely-fast-image-classifiers-with-mobilenet-in-tensorflow-f030ce0a2991" data-skip-onboarding="true" data-action-source="quote_menu--------------------------respond_text"><span class="svgIcon svgIcon--responseFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19.074 21.117c-1.244 0-2.432-.37-3.532-1.096a7.792 7.792 0 0 1-.703-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.662 0 8.457 3.5 8.457 7.803 0 2.058-.85 3.984-2.403 5.448.023.17.06.35.118.55.192.69.537 1.38 1.026 2.04.15.21.172.48.058.7a.686.686 0 0 1-.613.38h-.03z" fill-rule="evenodd"></path></svg></span></button><a class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--chromeless button--highlightMenu js-highlightMenuTwitterShare" href="https://medium.com/p/f030ce0a2991/share/twitter?type=highlight&amp;text=about%20the%20smallest%20MobileNet%20(0." title="Share on Twitter" aria-label="Share on Twitter" target="_blank" data-action="twitter"><span class="button-defaultState"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path></svg></span></span></a><div class="buttonSet-separator"></div><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="sign-up-prompt" data-sign-in-action="highlight" data-redirect="https://hackernoon.com/creating-insanely-fast-image-classifiers-with-mobilenet-in-tensorflow-f030ce0a2991" data-skip-onboarding="true" data-action-source="quote_menu--------------------------privatenote_text"><span class="svgIcon svgIcon--privatenoteFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M17.662 4.552H7.346A4.36 4.36 0 0 0 3 8.898v5.685c0 2.168 1.614 3.962 3.697 4.28v2.77c0 .303.35.476.59.29l3.904-2.994h6.48c2.39 0 4.35-1.96 4.35-4.35V8.9c0-2.39-1.95-4.346-4.34-4.346zM16 14.31a.99.99 0 0 1-1.003.99h-4.994C9.45 15.3 9 14.85 9 14.31v-3.02a.99.99 0 0 1 1-.99v-.782a2.5 2.5 0 0 1 2.5-2.51c1.38 0 2.5 1.13 2.5 2.51v.782c.552.002 1 .452 1 .99v3.02z"></path><path d="M14 9.81c0-.832-.674-1.68-1.5-1.68-.833 0-1.5.84-1.5 1.68v.49h3v-.49z"></path></g></svg></span></button></div></div><div class="highlightMenu-arrowClip"><span class="highlightMenu-arrow"></span></div></div></div></div></div></body></html>